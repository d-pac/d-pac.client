'use strict';
const pxquire = require( 'proxyquire' ).noCallThru();
const _ = require( 'lodash' );

// module.exports = {
//     extend: ( declaration ) =>{
//         const ctor = function(){
//             this.attrs = _.cloneDeep(declaration.defaults || {});
//         };
//         _.defaultsDeep( ctor.prototype, declaration, {
//             get: function( key ){
//                 return this.attrs[ key ];
//             },
//             set: function( key,
//                            value ){
//                 let obj = _.isString( key )
//                     ? { [key]: value }
//                     : key;
//                 _.each( obj, ( value,
//                                key )=>{
//                     this.attrs[ key ] = value;
//                 } );
//             }
//         } );
//         ctor.createMock = function(){
//             return new ctor();
//         };
//         return ctor;
//     }
// };
var jsdom = require("jsdom");
var window = jsdom.jsdom().defaultView;
const jquery = require( '../../bower_components/jquery/dist/jquery' )(window);
const backbone = pxquire( '../../bower_components/backbone', {
    underscore: _
} );
const PatchedBackbone = pxquire( '../../bower_components/backbone-nested-model', {
    jquery: jquery,
    underscore: _,
    backbone: backbone
} );

module.exports = {
    underscore: _,
    jquery : jquery,
    backbone: backbone,
    'backbone-nested-model': PatchedBackbone.NestedModel
};
